name: consensus
description: >
  Generates a consensus genome from raw sequencing reads using a flexible amplicon-based workflow.
  Supports Illumina or Nanopore input, read cleaning, alignment, primer trimming, and consensus calling.
keywords:
  - consensus
  - variant calling
  - amplicon
  - alignment
  - trimming
  - SARS-CoV-2
  - monkeypox
input:
  - ch_reads:
      description: |
        Paired-end Illumina reads
        Structure: [ val(meta), path(reads) ]
  - ch_nanopore: 
      description: |
        Nanopore reads
        Structure: [ val(meta), path(reads) ]
  - ch_reference:
      description: |
        Reference genome FASTA
        Structure: [ path(fa) ]
  - ch_primer_bed:
      description: | 
        Primer BED file for amplicon trimming
        Structure: [ path(bed) ]
output:
  - consensus:
      description: Consensus FASTA files generated by IVAR or ARTIC
  - just_bam:
      description: Aligned and sorted BAM files
  - trim_bam:
      description: Primer-trimmed BAM files
  - clean_reads:
      description: Quality- and adapter-trimmed reads
  - filtered_reads:
      description: BAM or fastq files after host/contaminant filtering
  - for_multiqc:
      description: Files for MultiQC input (e.g., QC reports from fastp or seqyclean)
  - versions:
      description: |
        Files containing software versions
        Structure: [ path(versions.yml) ]
tools:
  - bwa
  - minimap2
  - fastp
  - seqyclean
  - bbnorm
  - ivar
  - samtools
  - artic
  - bbtools
components:
  - artic
  - artic/filter
  - bwa
  - minimap2
  - fastp
  - seqyclean
  - bbnorm
  - ivar/consensus
  - ivar/trim
  - samtools/sort
  - samtools/ampliconclip
  - samtools/filter
  - samtools/markdup

authors:
  - Erin Young <eriny@utah.gov>